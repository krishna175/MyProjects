desc add_consumer

CREATE SEQUENCE consumer_seq
START WITH    111111
INCREMENT BY   1
NOCACHE   
NOCYCLE;

drop SEQUENCE consumer_seq
SELECT joindate,to_char(joindate,'hh:mi') FROM ADD_CONSUMER
UPDATE ADD_CONSUMER SET JOINDATE = SYSDATE WHERE CON_ID=111111
UPDATE ADD_CONSUMER SET JOINTIME = SYSTIMESTAMP WHERE CON_ID=111111

select sysdate,to_char(sysdate,'hh24:mi:ss') dat from dual

select add_months(to_date('23-08-21','dd-mm-yy'),5),to_date('01/feb/21','dd-mon/yy') from dual

SELECT * FROM ADD_CONSUMER
select * from meter_reading

insert into meter_reading select con_id ,200,sysdate from ADD_CONSUMER where con_id<>'111139'

update meter_reading set current_reading=current_reading*rownum

SELECT * FROM CHARGE_MASTER
TRUNCATE TABLE CHARGE_MASTER
INSERT INTO CHARGE_MASTER (CON_ID,SUPPLY_TYPE)  SELECT CON_ID,SUPPLY_TYPE FROM ADD_CONSUMER
UPDATE CHARGE_MASTER M SET CURRENT_UNIT=
(SELECT CURRENT_READING R FROM METER_READING R WHERE R.CON_ID=M.CON_ID AND 
READING_DATE BETWEEN '1-SEP-21' AND '30-SEP-21')
UPDATE CHARGE_MASTER M SET PRE_UNIT=
(SELECT UNIT_CONSUMED FROM CHARGE_MASTER_TRACK T WHERE T.CON_ID=M.CON_ID AND BILL_DATE='10-AUG-21')
UPDATE CHARGE_MASTER M SET PRE_UNIT=0 -- CHANGE
-- ADDITIONAL STEP 
UPDATE CHARGE_MASTER M SET UNIT_CONSUMED=CURRENT_UNIT-PRE_UNIT
-- BALANCE AMOUNT CALCULATION
UPDATE CHARGE_MASTER M SET BALANCE_AMT=0

UPDATE CHARGE_MASTER M SET ENERGY_CHAGE=UNIT_CONSUMED*3.05,FIXED_CHARGE=75 WHERE UNIT_CONSUMED<=100
UPDATE CHARGE_MASTER M SET ENERGY_CHAGE=305+(UNIT_CONSUMED-100)*5,FIXED_CHARGE=115
WHERE UNIT_CONSUMED>100 AND UNIT_CONSUMED<=300 
UPDATE CHARGE_MASTER M SET ENERGY_CHAGE=1305+(UNIT_CONSUMED-300)*6.65,FIXED_CHARGE=115
WHERE UNIT_CONSUMED>300 AND UNIT_CONSUMED<=500
UPDATE CHARGE_MASTER M SET ENERGY_CHAGE=2635+(UNIT_CONSUMED-500)*7.8,FIXED_CHARGE=140
WHERE UNIT_CONSUMED>500
UPDATE CHARGE_MASTER M SET WHEELING_CHARGE=UNIT_CONSUMED*1.46
UPDATE CHARGE_MASTER M SET GOV_CHARGE=(ENERGY_CHAGE+FIXED_CHARGE+WHEELING_CHARGE)*.16
-- UPDATE GOVT CHARGE
UPDATE CHARGE_MASTER M SET CHARGE_AMT=ENERGY_CHAGE+FIXED_CHARGE+WHEELING_CHARGE+GOV_CHARGE+BALANCE_AMT,
BILL_DATE=SYSDATE


CREATE TABLE CHARGE_MASTER_TRACK AS SELECT * FROM CHARGE_MASTER WHERE ROWNUM<10
UPDATE CHARGE_MASTER_TRACK SET BILL_DATE='10-AUG-21'
ALTER TABLE CHARGE_MASTER_TRACK ADD(BILL_STATUS VARCHAR2(15))
SELECT * FROM CHARGE_MASTER
SELECT * FROM CHARGE_MASTER_TRACK





   
SELECT * FROM ADD_CONSUMER WHERE CON_ID = (SELECT MAX(CON_ID) FROM ADD_CONSUMER)
SELECT JOINDATE,to_char(JOINDATE,'hh:mi') FROM ADD_CONSUMER

SELECT COUNT(*) FROM ADD_CONSUMER WHERE CON_ID=111114
